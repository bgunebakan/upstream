{% extends 'cruds/base.html' %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load render_table from django_tables2 %}
{% load crud_tags %}
{% load static %}
{% load personnel_tags %}
{% block title %}Portunes Access Control{% endblock %}

{% block page_name %}Portunes Access Control{% endblock %}
{% block page_description %}Dashboard{% endblock %}

{% block bodyclass %}skin-purple {%if config.hide_sidebar %}sidebar-collapse{%endif%} {% endblock %}

{% block content %}

<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    <a href="/users/detail/{{personnel.nat_id}}/">{{user.first_name}} {{user.last_name}}</a> Yetkileri
  </h1>
</section>

<!-- Main content -->
<section class="content">
  <div class="row">
    <div class="col-xs-6">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">Identifiers</h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
          <table class="table table-bordered text-center">
          <tbody>

             {% for id in identifier.all %}
              <a href="/portunes/identifier/{{id.id}}/update"><li class="fa fa-user" > {{id.name}} - {{id.key}}</li></a>
              <br>

              {% endfor %}
          </ul>
        </tbody></table>
        </div>
        <!-- /.box-body -->
      </div>
    </div>
    <div class="col-xs-6">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">Door Groups</h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
          <table class="table table-bordered text-center">
          <tbody>

             {% for door_group in door_groups.all %}
              <a href="/portunes/identifier/{{id.id}}/update"><li class="fa fa-archive" > {{door_group.name}}</li></a>
              <br>

              {% endfor %}
          </ul>
        </tbody></table>
        </div>
        <!-- /.box-body -->
      </div>
    </div>
    <div class="col-xs-12">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">{{table_label}}</h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
          <table class="table table-bordered text-center">
          <tbody>
          {% for controller in controllers.all %}
            {% cycle '<tr>' '' '' %}
                <td>
          <ul>
            <a href="/controllers/detail/{{controller.mac}}">
              <i class="fa fa-archive"></i> <span>{{ controller.name}}</span>
            </a><br>

            <form action="" method="post" name="form" id="form">
              {% csrf_token %}

             {% for door in doors.all %}

              {%if door.entrance.name == controller.name %}
              <li class="fa fa-code-fork" > {{door.entrance_controller_pin}} - {{door.name}}
                <input type="checkbox" name="permissions" value="{{door.id}}"
                id="{{door.name}}"
                {%for permission in permissions %}
                  {%if permission.door == door %}
                  checked
                  {%endif%}
                {%endfor%}
                >
              </li><br>
              {%endif%}
              {% endfor %}
                </td>
            {% cycle '' '' '</tr>' %}
          </ul>
          {% endfor %}
        </tbody></table>
          <div class="box-footer">
            <button type="submit" name="savepermission" value="savepermission" class="btn btn-primary">Kaydet</button>
            <button type="submit" name="clearpermission" value="clearpermission" class="btn btn-primary">Yetkileri sil</button>
          </div>
          </form>
        </div>
        <!-- /.box-body -->
      </div>
      <!-- /.box -->

    </div>
    <!-- /.col -->
  </div>
  <!-- /.row -->
</section>
<!-- /.content -->




{% endblock %}
